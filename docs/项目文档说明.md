# TripNara é¡¹ç›®ä»‹ç»æ–‡æ¡£

> æ™ºèƒ½æ—…è¡Œè§„åˆ’åç«¯æœåŠ¡ - åŸºäº NestJS çš„ä¼ä¸šçº§æ—…è¡Œè§„åˆ’ç³»ç»Ÿ

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
3. [æ ¸å¿ƒåŠŸèƒ½æ¨¡å—](#æ ¸å¿ƒåŠŸèƒ½æ¨¡å—)
4. [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
5. [API æ¥å£](#api-æ¥å£)
6. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
7. [éƒ¨ç½²è¯´æ˜](#éƒ¨ç½²è¯´æ˜)

---

## é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®ç®€ä»‹

TripNara æ˜¯ä¸€ä¸ªåŸºäº NestJS çš„æ™ºèƒ½æ—…è¡Œè§„åˆ’åç«¯æœåŠ¡ç³»ç»Ÿï¼Œæä¾›å®Œæ•´çš„æ—…è¡Œè§„åˆ’ã€è¡Œç¨‹ç®¡ç†ã€åœ°ç‚¹æ¨èã€è·¯çº¿ä¼˜åŒ–ç­‰åŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„è®¾è®¡ï¼Œæ”¯æŒå¤šæ•°æ®æºé›†æˆã€æ™ºèƒ½å†³ç­–å¼•æ“ã€AI è¾…åŠ©è§„åˆ’ç­‰é«˜çº§ç‰¹æ€§ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸ—ºï¸ **æ™ºèƒ½è¡Œç¨‹è§„åˆ’**ï¼šè‡ªåŠ¨ç”Ÿæˆä¼˜åŒ–çš„æ—…è¡Œè·¯çº¿
- ğŸ“ **åœ°ç‚¹æ¨èç³»ç»Ÿ**ï¼šåŸºäºåœ°ç†ä½ç½®å’Œç”¨æˆ·åå¥½çš„æ™ºèƒ½æ¨è
- ğŸš— **äº¤é€šè§„åˆ’**ï¼šæ™ºèƒ½äº¤é€šè·¯çº¿è§„åˆ’ä¸å†³ç­–
- ğŸ’° **ä»·æ ¼ä¼°ç®—**ï¼šæœºç¥¨ã€é…’åº—ä»·æ ¼å‚è€ƒä¸é¢„ç®—ç®¡ç†
- ğŸ¤– **AI è¾…åŠ©**ï¼šè¯­éŸ³è¯†åˆ«ã€å›¾åƒè¯†åˆ«ã€æ™ºèƒ½åŠ©æ‰‹
- ğŸ“Š **å†³ç­–å¼•æ“**ï¼šå¤šç­–ç•¥å†³ç­–ç³»ç»Ÿï¼ˆAbu/Dr.Dre/Neptuneï¼‰
- ğŸŒ **æ•°æ®å¥‘çº¦**ï¼šå¤šæ•°æ®æºé€‚é…å™¨æ¨¡å¼
- ğŸ”„ **å®æ—¶ä¼˜åŒ–**ï¼šè·¯çº¿ä¼˜åŒ–ã€èŠ‚å¥æ§åˆ¶ã€ç¨³å¥åº¦è¯„ä¼°

### æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**: NestJS 11
- **æ•°æ®åº“**: PostgreSQL + PostGISï¼ˆåœ°ç†ç©ºé—´æ•°æ®æ”¯æŒï¼‰
- **ORM**: Prisma 6
- **ç¼“å­˜**: Redis
- **API æ–‡æ¡£**: Swagger/OpenAPI
- **è¯­è¨€**: TypeScript 5
- **æµ‹è¯•**: Jest
- **å¤–éƒ¨æœåŠ¡**: Google Maps, Mapbox, é«˜å¾·åœ°å›¾, OpenWeather ç­‰

---

## æŠ€æœ¯æ¶æ„

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Gateway Layer                     â”‚
â”‚              (NestJS Controllers + Swagger)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Business      â”‚  â”‚  Decision      â”‚  â”‚  Agent         â”‚
â”‚  Logic Layer   â”‚  â”‚  Engine Layer  â”‚  â”‚  Router Layer  â”‚
â”‚                â”‚  â”‚                â”‚  â”‚                â”‚
â”‚  - Trips       â”‚  â”‚  - Abu         â”‚  â”‚  - System 1    â”‚
â”‚  - Places      â”‚  â”‚  - Dr.Dre      â”‚  â”‚  - System 2    â”‚
â”‚  - Optimizationâ”‚  â”‚  - Neptune     â”‚  â”‚  - ReAct       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Data Access Layer                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Prisma   â”‚  â”‚  Redis   â”‚  â”‚ External â”‚           â”‚
â”‚  â”‚  ORM     â”‚  â”‚  Cache   â”‚  â”‚  APIs    â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Infrastructure Layer                      â”‚
â”‚         PostgreSQL + PostGIS + Redis                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¨¡å—åŒ–è®¾è®¡

é¡¹ç›®é‡‡ç”¨ NestJS æ¨¡å—åŒ–æ¶æ„ï¼Œæ¯ä¸ªåŠŸèƒ½æ¨¡å—ç‹¬ç«‹å°è£…ï¼š

- **æ ¸å¿ƒä¸šåŠ¡æ¨¡å—**ï¼šTrips, Places, ItineraryItems, Transport ç­‰
- **æ™ºèƒ½å†³ç­–æ¨¡å—**ï¼šDecision Engine, Agent Router, Planning Policy
- **æ•°æ®æœåŠ¡æ¨¡å—**ï¼šData Contracts, Flight Prices, Hotels
- **åŸºç¡€è®¾æ–½æ¨¡å—**ï¼šPrisma, Redis, Providers

---

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### 1. è¡Œç¨‹ç®¡ç†æ¨¡å— (`/src/trips/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šç®¡ç†ç”¨æˆ·è¡Œç¨‹çš„åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°å’ŒçŠ¶æ€ç®¡ç†ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… åˆ›å»ºè¡Œç¨‹ï¼ˆè‡ªåŠ¨è®¡ç®—é¢„ç®—åˆ‡åˆ†å’ŒèŠ‚å¥ç­–ç•¥ï¼‰
- âœ… è·å–è¡Œç¨‹è¯¦æƒ…å’Œå½“å‰çŠ¶æ€
- âœ… Schedule è¯»å†™ï¼ˆç®—æ³•è§†å›¾å’Œæ•°æ®åº“è§†å›¾è½¬æ¢ï¼‰
- âœ… æ—…è¡Œå‡†å¤‡åº¦æ£€æŸ¥ï¼ˆReadiness Moduleï¼‰
- âœ… å†³ç­–å¼•æ“é›†æˆï¼ˆDecision Layerï¼‰

**å…³é”®æœåŠ¡**ï¼š
- `trips.service.ts`: è¡Œç¨‹ä¸šåŠ¡é€»è¾‘
- `readiness/`: æ—…è¡Œå‡†å¤‡åº¦æ£€æŸ¥æœåŠ¡
- `decision/`: å†³ç­–å±‚æœåŠ¡ï¼ˆAbu/Dr.Dre/Neptune ç­–ç•¥ï¼‰

**ç›¸å…³æ–‡æ¡£**ï¼š
- `/src/trips/decision/README.md` - å†³ç­–å±‚è¯¦ç»†è¯´æ˜
- `/src/trips/readiness/README.md` - å‡†å¤‡åº¦æ£€æŸ¥è¯´æ˜

---

### 2. åœ°ç‚¹ç®¡ç†æ¨¡å— (`/src/places/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šç®¡ç†åœ°ç‚¹ï¼ˆPlaceï¼‰æ•°æ®ï¼ŒåŒ…æ‹¬æ™¯ç‚¹ã€é¤å…ã€é…’åº—ç­‰ POI ä¿¡æ¯ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… é™„è¿‘åœ°ç‚¹æŸ¥è¯¢ï¼ˆåŸºäº PostGIS åœ°ç†ç©ºé—´æŸ¥è¯¢ï¼‰
- âœ… å…³é”®è¯æœç´¢å’Œè‡ªåŠ¨è¡¥å…¨
- âœ… é…’åº—æ¨èï¼ˆç»¼åˆéšå½¢æˆæœ¬è®¡ç®—ï¼‰
- âœ… è·¯çº¿éš¾åº¦è®¡ç®—ï¼ˆåŸºäºé«˜ç¨‹ã€è·ç¦»ã€å¡åº¦ï¼‰
- âœ… è‡ªç„¶ POI ç®¡ç†ï¼ˆå¾’æ­¥è·¯çº¿ã€æ™¯ç‚¹ç­‰ï¼‰
- âœ… æ™¯ç‚¹ä¿¡æ¯ä¸°å¯ŒåŒ–ï¼ˆä»é«˜å¾·åœ°å›¾ã€Google Places è·å–ï¼‰

**å…³é”®æœåŠ¡**ï¼š
- `places.service.ts`: åœ°ç‚¹ä¸šåŠ¡é€»è¾‘
- `services/route-difficulty.service.ts`: è·¯çº¿éš¾åº¦è¯„ä¼°
- `services/hotel-recommendation.service.ts`: é…’åº—æ¨è
- `services/nature-poi.service.ts`: è‡ªç„¶ POI æœåŠ¡

**æ•°æ®æºé›†æˆ**ï¼š
- Google Places API
- é«˜å¾·åœ°å›¾ API
- Mapbox API
- Overpass API (OpenStreetMap)
- AllTrailsï¼ˆå¾’æ­¥è·¯çº¿æ•°æ®ï¼‰

---

### 3. è¡Œç¨‹é¡¹ç®¡ç†æ¨¡å— (`/src/itinerary-items/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šç®¡ç†è¡Œç¨‹é¡¹ï¼ˆItineraryItemï¼‰ï¼ŒåŒ…æ‹¬æ´»åŠ¨ã€ç”¨é¤ã€ä¼‘æ¯ã€äº¤é€šç­‰ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… CRUD æ“ä½œ
- âœ… è‡ªåŠ¨æ ¡éªŒè¥ä¸šæ—¶é—´å’Œæ—¶é—´é€»è¾‘
- âœ… æ—¶é—´æ§½ç®¡ç†

---

### 4. è·¯çº¿ä¼˜åŒ–æ¨¡å— (`/src/itinerary-optimization/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šä½¿ç”¨èŠ‚å¥æ„Ÿç®—æ³•ä¼˜åŒ–æ—…è¡Œè·¯çº¿ã€‚

**æ ¸å¿ƒç®—æ³•**ï¼š4 ç»´å¹³è¡¡ç®—æ³•
1. **ç©ºé—´èšç±»**ï¼šæ‹’ç»"æŠ˜è¿”è·‘"ï¼Œä¼˜åŒ–ç©ºé—´è·¯å¾„
2. **èŠ‚å¥æ§åˆ¶**ï¼šå¼ºåº¦äº¤æ›¿ï¼Œé¿å…ç–²åŠ³
3. **ç”Ÿç‰©é’Ÿé”šå®š**ï¼šé¥­ç‚¹ä¼˜å…ˆï¼Œç¬¦åˆäººä½“èŠ‚å¾‹
4. **å®¹é”™ä¸ç•™ç™½**ï¼šå¼¹æ€§å› å­ï¼Œé¢„ç•™ç¼“å†²æ—¶é—´

**å…³é”®æœåŠ¡**ï¼š
- `itinerary-optimization.service.ts`: ä¼˜åŒ–ä¸šåŠ¡é€»è¾‘
- `services/route-optimizer.service.ts`: è·¯çº¿ä¼˜åŒ–å™¨ï¼ˆæ¨¡æ‹Ÿé€€ç«ç®—æ³•ï¼‰
- `services/spatial-clustering.service.ts`: ç©ºé—´èšç±»æœåŠ¡
- `services/happiness-scorer.service.ts`: å¿«ä¹å€¼è¯„åˆ†æœåŠ¡

---

### 5. äº¤é€šè§„åˆ’æ¨¡å— (`/src/transport/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šæ™ºèƒ½äº¤é€šè·¯çº¿è§„åˆ’ä¸å†³ç­–ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… è‡ªåŠ¨åŒºåˆ†å¤§äº¤é€šï¼ˆåŸå¸‚é—´ï¼‰å’Œå°äº¤é€šï¼ˆå¸‚å†…ï¼‰
- âœ… æ ¹æ®ç”¨æˆ·ç”»åƒï¼ˆè¡Œæã€è€äººã€å¤©æ°”ï¼‰æ™ºèƒ½æ’åº
- âœ… è®¡ç®—"ç—›è‹¦æŒ‡æ•°"ï¼Œæ¨èæœ€èˆ’é€‚çš„æ–¹æ¡ˆ
- âœ… è·¯çº¿ç¼“å­˜ä¼˜åŒ–

**å…³é”®æœåŠ¡**ï¼š
- `transport-routing.service.ts`: äº¤é€šè·¯çº¿æœåŠ¡
- `transport-decision.service.ts`: äº¤é€šå†³ç­–æœåŠ¡
- `services/smart-routes.service.ts`: æ™ºèƒ½è·¯çº¿æœåŠ¡
- `services/route-cache.service.ts`: è·¯çº¿ç¼“å­˜æœåŠ¡

**æ•°æ®æº**ï¼š
- é«˜å¾·åœ°å›¾è·¯çº¿ API
- Google Routes API

---

### 6. è§„åˆ’ç­–ç•¥æ¨¡å— (`/src/planning-policy/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šè¡Œç¨‹è®¡åˆ’çš„ç¨³å¥åº¦è¯„ä¼°å’Œ What-If åˆ†æã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… What-If è¯„ä¼°æŠ¥å‘Šï¼ˆç”Ÿæˆå€™é€‰æ–¹æ¡ˆå¹¶è¯„ä¼°ï¼‰
- âœ… ç¨³å¥åº¦è¯„ä¼°ï¼ˆæ—¶é—´çª—å£é”™è¿‡æ¦‚ç‡ã€å®Œæˆç‡ç­‰ï¼‰
- âœ… åº”ç”¨å€™é€‰æ–¹æ¡ˆ
- âœ… ä¸€é”®å¤è¯„

**å…³é”®æœåŠ¡**ï¼š
- `services/robustness-evaluator.service.ts`: ç¨³å¥åº¦è¯„ä¼°æœåŠ¡
- `services/day-scheduler.service.ts`: æ—¥ç¨‹è°ƒåº¦æœåŠ¡
- `services/hp-simulator.service.ts`: ä½“åŠ›å€¼æ¨¡æ‹Ÿå™¨
- `services/cost-model.service.ts`: æˆæœ¬æ¨¡å‹æœåŠ¡

---

### 7. å†³ç­–å¼•æ“æ¨¡å— (`/src/trips/decision/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šå°†æ—…è¡Œè§„åˆ’ä»"ç”Ÿæˆæ–‡æœ¬"å‡çº§æˆ"æ±‚è§£ä¸€ä¸ªå¯æ‰§è¡Œçš„åŠ¨æ€è®¡åˆ’"çš„é«˜ç»´æ¡†æ¶ã€‚

**æ ¸å¿ƒæ€æƒ³**ï¼šStateï¼ˆä¸–ç•ŒçŠ¶æ€ï¼‰+ Constraintsï¼ˆçº¦æŸï¼‰+ Objectiveï¼ˆç›®æ ‡å‡½æ•°ï¼‰+ Actionsï¼ˆåŠ¨ä½œï¼‰

**ä¸‰ä¸ªå†³ç­–ç­–ç•¥**ï¼š

1. **Abuï¼ˆä¿è°ï¼‰** - Risk-based Prioritization
   - å½“æ—¶é—´/ä½“åŠ›/é¢„ç®—ä¸å¤Ÿæ—¶ï¼Œä¿æ ¸å¿ƒä½“éªŒï¼Œç è¾¹è§’
   - å¯è§£é‡Šçš„ä¼˜å…ˆçº§å†³ç­–

2. **Dr.Dreï¼ˆç è°ï¼‰** - Constraint-based Elimination
   - åŸºäºçº¦æŸçš„æ¶ˆé™¤ç­–ç•¥
   - è‡ªåŠ¨è¯†åˆ«å¹¶ç§»é™¤ä¸å¯è¡Œé¡¹

3. **Neptuneï¼ˆè°ƒè°ï¼‰** - Optimization-based Rebalancing
   - åŸºäºä¼˜åŒ–çš„é‡æ–°å¹³è¡¡
   - åŠ¨æ€è°ƒæ•´è®¡åˆ’ä»¥ä¼˜åŒ–ç›®æ ‡å‡½æ•°

**ç›¸å…³æ–‡æ¡£**ï¼š
- `/src/trips/decision/README.md` - è¯¦ç»†æ¶æ„è¯´æ˜

---

### 8. Agent æ¨¡å— (`/src/agent/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šæ™ºèƒ½è·¯ç”±å’Œæ‰§è¡Œç³»ç»Ÿï¼Œå®ç°åŒç³»ç»Ÿæ¶æ„ï¼ˆSystem 1 / System 2ï¼‰ã€‚

**æ¶æ„è®¾è®¡**ï¼š

- **System 1ï¼ˆå¿«ï¼‰**ï¼š
  - `SYSTEM1_API`: æ ‡å‡† API / CRUD / ç®€å•æŸ¥è¯¢
  - `SYSTEM1_RAG`: çŸ¥è¯†åº“/å‘é‡æ£€ç´¢

- **System 2ï¼ˆæ…¢ï¼‰**ï¼š
  - `SYSTEM2_REASONING`: ReAct + å·¥å…· + TravelPlanner/Critic
  - `SYSTEM2_WEBBROWSE`: æ— å¤´æµè§ˆå™¨å…œåº•ï¼ˆä»…æˆæƒåï¼‰

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… è¯­ä¹‰è·¯ç”±ï¼ˆè‡ªåŠ¨è¯†åˆ«ç”¨æˆ·æ„å›¾ï¼‰
- âœ… ç»Ÿä¸€å…¥å£ï¼ˆ`/agent/route_and_run`ï¼‰
- âœ… å·¥å…·è°ƒç”¨ï¼ˆTravelPlanner, Critic ç­‰ï¼‰
- âœ… æˆæœ¬æ§åˆ¶ï¼ˆToken é¢„ç®—ç®¡ç†ï¼‰

**ç›¸å…³æ–‡æ¡£**ï¼š
- `/src/agent/README.md` - Agent æ¨¡å—è¯¦ç»†è¯´æ˜

---

### 9. æ•°æ®å¥‘çº¦æ¨¡å— (`/src/data-contracts/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šåˆ†å±‚æ•°æ®æ²»ç†æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼ï¼Œæ”¯æŒå¤šæ•°æ®æºé›†æˆã€‚

**æ¶æ„è®¾è®¡**ï¼š

1. **å…¨çƒé€šç”¨å±‚**ï¼šé€šè¿‡ OpenWeatherã€Google Traffic ç­‰é€šç”¨ API è¦†ç›– 80% éœ€æ±‚
2. **å›½å®¶/åœºæ™¯æ’ä»¶å±‚**ï¼šé’ˆå¯¹é«˜å®¢å•ä»·/é«˜éš¾åº¦åœºæ™¯çš„å®šåˆ¶æ•°æ®æºï¼ˆå¦‚å†°å²› Road.isï¼‰
3. **æŒ‰éœ€è§¦å‘**ï¼šæ ¹æ®ç»çº¬åº¦è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„æ•°æ®é€‚é…å™¨

**æ ‡å‡†æ•°æ®å¥‘çº¦**ï¼š
- `RoadStatus` - è·¯å†µçŠ¶æ€
- `WeatherData` - å¤©æ°”æ•°æ®
- `TransportSchedule` - å…¬å…±äº¤é€šæ—¶åˆ»è¡¨
- `FerrySchedule` - è½®æ¸¡æ—¶åˆ»è¡¨

**é€‚é…å™¨å®ç°**ï¼š
- `iceland-aurora.adapter.ts`: å†°å²›æå…‰/è·¯å†µé€‚é…å™¨
- `default-weather.adapter.ts`: é»˜è®¤å¤©æ°”é€‚é…å™¨
- `default-road-status.adapter.ts`: é»˜è®¤è·¯å†µé€‚é…å™¨

**ç›¸å…³æ–‡æ¡£**ï¼š
- `/src/data-contracts/README.md` - æ•°æ®å¥‘çº¦æ¨¡å—è¯¦ç»†è¯´æ˜

---

### 10. è¯­éŸ³ä¸è§†è§‰æ¨¡å—

#### è¯­éŸ³æ¨¡å— (`/src/voice/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šè§£æè¯­éŸ³è½¬æ–‡å­—çš„ transcriptï¼Œç”Ÿæˆç»“æ„åŒ–åŠ¨ä½œå»ºè®®ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… å°†è¯­éŸ³æ–‡æœ¬è§£æä¸ºåŠ¨ä½œå»ºè®®ï¼ˆQUERY_NEXT_STOP, MOVE_POI_TO_MORNING ç­‰ï¼‰
- âœ… å¦‚æœä¿¡æ¯ä¸è¶³ï¼Œè¿”å› clarificationï¼ˆéœ€è¦ç”¨æˆ·é€‰æ‹©ï¼‰

#### è§†è§‰æ¨¡å— (`/src/vision/`)

**åŠŸèƒ½æ¦‚è¿°**ï¼šæ‹ç…§è¯†åˆ« POI æ¨èã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… OCR æå–æ–‡å­—ï¼ˆæ‹›ç‰Œ/èœå•ï¼‰
- âœ… POI Resolverï¼šç”¨æ–‡å­— + ç”¨æˆ·å®šä½æœç´¢ POI
- âœ… è¿”å›å€™é€‰ POI åˆ—è¡¨å’Œ"åŠ å…¥è¡Œç¨‹"å»ºè®®

---

### 11. å…¶ä»–æ ¸å¿ƒæ¨¡å—

#### æœºç¥¨ä»·æ ¼æ¨¡å— (`/src/flight-prices/`)
- æœºç¥¨ä»·æ ¼å‚è€ƒæ•°æ®ç®¡ç†
- ä¼°ç®—æœºç¥¨+ç­¾è¯æˆæœ¬
- ä»·æ ¼è¶‹åŠ¿æŸ¥è¯¢

#### é…’åº—ä»·æ ¼æ¨¡å— (`/src/hotels/`)
- é…’åº—ä»·æ ¼ä¼°ç®—å’Œæ¨è
- æ ¹æ®åŸå¸‚ã€æ˜Ÿçº§ä¼°ç®—ä»·æ ¼
- å­£åº¦ä»·æ ¼è¶‹åŠ¿

#### å›½å®¶æ¡£æ¡ˆæ¨¡å— (`/src/countries/`)
- ç®¡ç†å›½å®¶æ¡£æ¡ˆä¿¡æ¯ï¼ˆè´§å¸ã€æ”¯ä»˜ã€ç­¾è¯ç­‰ï¼‰
- è·å–è´§å¸ç­–ç•¥ï¼ˆæ±‡ç‡ã€æ”¯ä»˜æ–¹å¼ã€é€Ÿç®—å£è¯€ï¼‰

#### RailPass æ¨¡å— (`/src/railpass/`)
- RailPass åˆè§„ä¸è®¢åº§å†³ç­–
- è§„åˆ™å¼•æ“å’Œçº¦æŸæ£€æŸ¥

---

## æ•°æ®æ¨¡å‹

### æ ¸å¿ƒæ•°æ®æ¨¡å‹ï¼ˆPrisma Schemaï¼‰

ä¸»è¦æ•°æ®æ¨¡å‹åŒ…æ‹¬ï¼š

#### 1. Placeï¼ˆåœ°ç‚¹ï¼‰
- æ™¯ç‚¹ã€é¤å…ã€é…’åº—ç­‰ POI ä¿¡æ¯
- æ”¯æŒåœ°ç†ç©ºé—´æ•°æ®ï¼ˆPostGIS Pointï¼‰
- åŒ…å«ç‰©ç†å…ƒæ•°æ®ï¼ˆæµ·æ‹”ã€éš¾åº¦ç­‰ï¼‰

#### 2. Tripï¼ˆè¡Œç¨‹ï¼‰
- ç”¨æˆ·è¡Œç¨‹ä¸»è¡¨
- åŒ…å«é¢„ç®—ã€èŠ‚å¥é…ç½®ç­‰

#### 3. TripDayï¼ˆè¡Œç¨‹æ—¥æœŸï¼‰
- è¡Œç¨‹çš„æ—¥æœŸä¿¡æ¯

#### 4. ItineraryItemï¼ˆè¡Œç¨‹é¡¹ï¼‰
- å…·ä½“çš„æ´»åŠ¨é¡¹
- åŒ…å«æ—¶é—´æ§½ã€åœ°ç‚¹ã€ç±»å‹ç­‰ä¿¡æ¯

#### 5. Cityï¼ˆåŸå¸‚ï¼‰
- åŸå¸‚ä¿¡æ¯
- æ”¯æŒå¤šè¯­è¨€åç§°
- åŒ…å«æ—¶åŒºã€è¡Œæ”¿åŒºåˆ’ä»£ç ç­‰

#### 6. CountryProfileï¼ˆå›½å®¶æ¡£æ¡ˆï¼‰
- å›½å®¶ä¿¡æ¯ï¼ˆè´§å¸ã€æ”¯ä»˜ã€ç­¾è¯ç­‰ï¼‰
- æ”¯æŒå›½é™…åŒ–æ‰©å±•

#### 7. FlightPriceDetailï¼ˆæœºç¥¨ä»·æ ¼è¯¦æƒ…ï¼‰
- æœºç¥¨ä»·æ ¼å‚è€ƒæ•°æ®
- æ”¯æŒè·¯çº¿ã€æœˆä»½ã€æ˜ŸæœŸç­‰ç»´åº¦

#### 8. HotelPriceDetailï¼ˆé…’åº—ä»·æ ¼è¯¦æƒ…ï¼‰
- é…’åº—ä»·æ ¼å‚è€ƒæ•°æ®

è¯¦ç»†çš„æ•°æ®æ¨¡å‹å®šä¹‰è¯·æŸ¥çœ‹ `/prisma/schema.prisma`ã€‚

---

## API æ¥å£

### API æ–‡æ¡£

ç³»ç»Ÿæä¾›å®Œæ•´çš„ Swagger/OpenAPI æ–‡æ¡£ï¼Œå¯åŠ¨æœåŠ¡åè®¿é—®ï¼š
```
http://localhost:3000/api
```

### ä¸»è¦ API ç«¯ç‚¹

#### è¡Œç¨‹ç®¡ç†
- `POST /trips` - åˆ›å»ºè¡Œç¨‹
- `GET /trips/:id` - è·å–è¡Œç¨‹è¯¦æƒ…
- `PATCH /trips/:id` - æ›´æ–°è¡Œç¨‹

#### åœ°ç‚¹æŸ¥è¯¢
- `GET /places/nearby` - é™„è¿‘åœ°ç‚¹æŸ¥è¯¢
- `GET /places/search` - å…³é”®è¯æœç´¢
- `GET /places/recommend-hotels` - é…’åº—æ¨è

#### è·¯çº¿ä¼˜åŒ–
- `POST /itinerary-optimization/optimize` - ä¼˜åŒ–è·¯çº¿

#### äº¤é€šè§„åˆ’
- `POST /transport/routing` - äº¤é€šè·¯çº¿è§„åˆ’

#### Agent ç»Ÿä¸€å…¥å£
- `POST /agent/route_and_run` - æ™ºèƒ½è·¯ç”±å’Œæ‰§è¡Œ

è¯¦ç»† API æ–‡æ¡£è¯·æŸ¥çœ‹ï¼š
- `/docs/API-æ¥å£æ–‡æ¡£-å‰ç«¯ä½¿ç”¨æŒ‡å—.md`

---

## å¼€å‘æŒ‡å—

### ç¯å¢ƒè¦æ±‚

- Node.js >= 20
- PostgreSQL >= 14ï¼ˆéœ€å®‰è£… PostGIS æ‰©å±•ï¼‰
- Redis >= 6

### å®‰è£…ä¾èµ–

```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥å’Œå…¶ä»–æœåŠ¡å¯†é’¥ï¼š

```bash
DATABASE_URL="postgresql://user:password@localhost:5432/tripnara"
REDIS_URL="redis://localhost:6379"
GOOGLE_PLACES_API_KEY="your_key"
GOOGLE_VISION_API_KEY="your_key"
MAPBOX_API_KEY="your_key"
# ... å…¶ä»–ç¯å¢ƒå˜é‡
```

### æ•°æ®åº“è¿ç§»

```bash
# ç”Ÿæˆ Prisma Client
npm run prisma:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
npm run prisma:migrate
```

### å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev

# æˆ–ä½¿ç”¨åç«¯ä¸“ç”¨å‘½ä»¤
npm run backend:dev
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# è¿è¡Œç‰¹å®šæ¨¡å—æµ‹è¯•
npm run test:agent

# æµ‹è¯•è¦†ç›–ç‡
npm run test:coverage
```

---

## å¸¸ç”¨å¼€å‘è„šæœ¬

é¡¹ç›®æä¾›äº†ä¸°å¯Œçš„å¼€å‘è„šæœ¬ï¼ŒæŒ‰åŠŸèƒ½åˆ†ç±»å¦‚ä¸‹ï¼š

### ğŸ“¦ åŸºç¡€å¼€å‘å‘½ä»¤

#### å¼€å‘ä¸æ„å»º
```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼ˆçƒ­é‡è½½ï¼‰
npm run dev
# æˆ–
npm run backend:dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
# æˆ–
npm run backend:build

# è¿è¡Œç”Ÿäº§æœåŠ¡å™¨
npm run start
# æˆ–
npm run backend:start
```

#### ä»£ç è´¨é‡
```bash
# ä»£ç æ£€æŸ¥
npm run lint
```

#### æ•°æ®åº“ç®¡ç†
```bash
# ç”Ÿæˆ Prisma Client
npm run prisma:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
npm run prisma:migrate

# æ‰“å¼€ Prisma Studioï¼ˆæ•°æ®åº“å¯è§†åŒ–å·¥å…·ï¼‰
npm run prisma:studio
```

---

### ğŸ—„ï¸ æ•°æ®å¯¼å…¥è„šæœ¬

#### åŸå¸‚æ•°æ®
```bash
# å¯¼å…¥åŸå¸‚æ•°æ®
npm run import:cities

# ä» CSV å¯¼å…¥åŸå¸‚
npm run import:cities:csv

# è½¬æ¢åŸå¸‚æ•°æ®æ ¼å¼
npm run convert:cities
```

#### æœºåœºæ•°æ®
```bash
# å¯¼å…¥æœºåœºæ•°æ®
npm run import:airports
```

#### POI æ•°æ®
```bash
# å¯¼å…¥è‡ªç„¶ POIï¼ˆä» GeoJSONï¼‰
npm run import:nature-poi

# å¯¼å…¥æ™¯ç‚¹æ•°æ®
npm run import:attractions

# è½¬æ¢æ™¯ç‚¹æ•°æ®ä¸º Place
npm run convert:attractions

# å¯¼å…¥é…’åº—æ•°æ®
npm run import:hotels

# å¯¼å…¥ç«è½¦ç«™æ•°æ®
npm run import:train-stations

# è½¬æ¢ç«è½¦ç«™æ•°æ®ä¸º Place
npm run convert:train-stations
```

#### AllTrails æ•°æ®
```bash
# å¯¼å…¥ AllTrails æ•°æ®åˆ°æ•°æ®åº“
npm run import:alltrails

# æ›´æ–° AllTrails é«˜ç¨‹æ•°æ®
npm run update:alltrails:elevation
```

#### GPX æ•°æ®
```bash
# å¯¼å…¥ GPX æ–‡ä»¶åˆ° Place
npm run import:gpx
```

#### DEMï¼ˆæ•°å­—é«˜ç¨‹æ¨¡å‹ï¼‰æ•°æ®
```bash
# å¯¼å…¥è¥¿è— DEM æ•°æ®ï¼ˆTypeScriptï¼‰
npm run import:dem:xizang

# å¯¼å…¥è¥¿è— DEM æ•°æ®ï¼ˆPythonï¼‰
npm run import:dem:xizang:python

# å¯¼å…¥è¥¿è— DEM æ•°æ®ï¼ˆBashï¼‰
npm run import:dem:xizang:bash

# å¯¼å…¥åŸå¸‚ DEM æ•°æ®
npm run import:dem:city

# æ‰¹é‡å¯¼å…¥åŸå¸‚ DEM æ•°æ®
npm run import:dem:cities:batch

# å¯¼å…¥å…¨çƒ DEM æ•°æ®
npm run import:dem:global

# åˆå¹¶åŸå¸‚ DEM æ•°æ®
npm run merge:dem:cities

# æ¸…ç†åŸå¸‚ DEM è¡¨
npm run cleanup:dem:cities
```

#### OSM POI æ•°æ®
```bash
# è·å–è¥¿è— OSM POI æ•°æ®
npm run fetch:poi:xizang

# è·å–æ–°è¥¿å…° OSM POI æ•°æ®
npm run fetch:poi:newzealand
```

---

### ğŸ” æ•°æ®çˆ¬å–è„šæœ¬

#### æ™¯ç‚¹æ•°æ®çˆ¬å–
```bash
# çˆ¬å–é©¬èœ‚çªæ™¯ç‚¹æ•°æ®
npm run scrape:mafengwo

# çˆ¬å–é£çŒªæ™¯ç‚¹æ•°æ®
npm run scrape:fliggy

# çˆ¬å–åœ°ç‚¹æ•°æ®
npm run scrape
```

#### AllTrails æ•°æ®çˆ¬å–
```bash
# çˆ¬å– AllTrails æ•°æ®
npm run scrape:alltrails

# ä½¿ç”¨ Puppeteer çˆ¬å– AllTrails
npm run scrape:alltrails:puppeteer

# æ‰¹é‡çˆ¬å– AllTrails
npm run scrape:alltrails:batch
```

#### å…¶ä»–æ•°æ®çˆ¬å–
```bash
# çˆ¬å–è¥¿è—è·¯çº¿æ•°æ®
npm run scrape:tibet

# çˆ¬å–ç­¾è¯æ•°æ®
npm run scrape:visa
```

---

### ğŸ”„ æ•°æ®æ›´æ–°è„šæœ¬

#### æ™¯ç‚¹ä¿¡æ¯ä¸°å¯ŒåŒ–
```bash
# ä»é«˜å¾·åœ°å›¾ä¸°å¯Œæ™¯ç‚¹ä¿¡æ¯
npm run enrich:amap
# æˆ–
npm run enrich:attractions
```

#### æ•°æ®ä¿®å¤ä¸æ›´æ–°
```bash
# æ›´æ–°æ™¯ç‚¹æ•°æ®
npm run update:attractions

# æ›´æ–°å¸ƒè¾¾æ‹‰å®«æ•°æ®
npm run update:potala

# æ›´æ–°ç‰©ç†å…ƒæ•°æ®
npm run update:physical-metadata

# ä»æ¨¡æ¿æ›´æ–°ç‰©ç†å…ƒæ•°æ®
npm run update:place:effort

# æ›´æ–°ä¸­å›½å±±åœ°ä½“åŠ›æ¶ˆè€—æ•°æ®
npm run update:china:mountain:effort
```

#### å…ƒæ•°æ®ç”Ÿæˆ
```bash
# ç”Ÿæˆç‰©ç†å…ƒæ•°æ®
npm run generate:physical-metadata

# ç”Ÿæˆåœ°ç‚¹åµŒå…¥å‘é‡
npm run generate:embeddings
```

#### æ•°æ®å¡«å……
```bash
# å¡«å……åœ°ç‚¹è‹±æ–‡åç§°
npm run fill:name-en

# å¡«å……åœ°ç‚¹åŸå¸‚ ID
npm run fill:cityid
```

#### POI æ•°æ®æ›´æ–°
```bash
# ä» DEM æ›´æ–° POI æµ·æ‹”
npm run update:poi:altitude:dem
```

---

### ğŸ’° ä»·æ ¼æ•°æ®ç®¡ç†

#### æœºç¥¨ä»·æ ¼
```bash
# å¯¼å…¥æœºç¥¨æ•°æ®
npm run import:flight-data

# æµå¼å¯¼å…¥æœºç¥¨æ•°æ®
npm run import:flight-data:streaming

# å¯¼å…¥æœºç¥¨ä»·æ ¼å‚è€ƒæ•°æ®
npm run seed:flight-prices

# æ¸…ç†æœºç¥¨ä»·æ ¼æ•°æ®
npm run clear:flight-prices

# æ¸…ç†æœºç¥¨ä»·æ ¼è¯¦ç»†æ•°æ®
npm run clear:flight-price-data

# éªŒè¯æœºç¥¨æ•°æ®
npm run verify:flight-data

# åˆ›å»ºæœºç¥¨ä»·æ ¼è¡¨
npm run create:flight-table
```

#### æ•°æ®è½¬æ¢
```bash
# Excel è½¬ CSV
npm run convert:excel-to-csv
```

---

### ğŸŒ å›½å®¶ä¸ç­¾è¯æ•°æ®

```bash
# ä¼˜åŒ–å›½å®¶æ¡£æ¡ˆ
npm run optimize:countries

# æ£€æŸ¥ç­¾è¯æ•°æ®
npm check:visa

# å¯¼å…¥ç­¾è¯è¦æ±‚æ•°æ®
npm run seed:visa

# å¯¼å…¥æ”¯ä»˜æ¡£æ¡ˆæ•°æ®
npm run seed:payment-profiles
```

---

### ğŸ§ª æµ‹è¯•è„šæœ¬

#### åŠŸèƒ½æµ‹è¯•
```bash
# æµ‹è¯•è·¯çº¿ä¼˜åŒ– API
npm run test:optimize

# æµ‹è¯• Prophetï¼ˆæ—¶é—´åºåˆ—é¢„æµ‹ï¼‰
npm run test:prophet

# æµ‹è¯• DEM é«˜ç¨‹
npm run test:dem

# æµ‹è¯• DEM ç”¨æˆ·åœºæ™¯
npm run test:dem:scenarios

# æµ‹è¯• DEM ä½“åŠ›æ¶ˆè€—åœºæ™¯
npm run test:dem:effort
```

#### å•å…ƒæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test:watch

# æµ‹è¯•è¦†ç›–ç‡
npm run test:coverage

# è¿è¡Œ Agent æ¨¡å—æµ‹è¯•
npm run test:agent
```

---

### ğŸ”§ æ•°æ®è¯Šæ–­ä¸ä¿®å¤

```bash
# è¯Šæ–­ POI é—®é¢˜
npm run diagnose:poi

# è¯Šæ–­åœ°ç‚¹æ•°æ®
npm run diagnose:place

# æ£€æŸ¥åœ°ç‚¹åæ ‡
npm run check:place-coords

# æ£€æŸ¥æ•°æ®åˆ—
npm run check:data-columns

# é€šè¿‡åç§°ä¿®å¤åæ ‡
npm run fix:coordinates
```

---

### ğŸ“Š æ‰¹é‡å¤„ç†è„šæœ¬

```bash
# æ‰¹é‡è®¡ç®—è·¯çº¿éš¾åº¦
npm run batch:calculate:difficulty
```

---

### ğŸ—‘ï¸ æ•°æ®æ¸…ç†

```bash
# æ¸…ç†æµ‹è¯•æ•°æ®
npm run clear:test-data
```

---

### ğŸ”„ æ•°æ®åº“è¿ç§»

```bash
# è¿ç§»æ·»åŠ æµ·æ‹”æç¤º
npm run migrate:altitude-hint
```

---

### ğŸ“ æ•°æ®ç§å­è„šæœ¬

```bash
# å¯¼å…¥åœ°ç‚¹æ•°æ®ç§å­
npm run seed

# å¯¼å…¥åœ°ç‚¹æ•°æ®ç§å­ï¼ˆPlacesï¼‰
npm run seed:places
```

---

### ğŸ’¡ è„šæœ¬ä½¿ç”¨å»ºè®®

1. **é¦–æ¬¡è®¾ç½®**ï¼š
   ```bash
   # 1. å®‰è£…ä¾èµ–
   npm install
   
   # 2. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆ.envï¼‰
   
   # 3. ç”Ÿæˆ Prisma Client
   npm run prisma:generate
   
   # 4. è¿è¡Œæ•°æ®åº“è¿ç§»
   npm run prisma:migrate
   
   # 5. å¯¼å…¥åŸºç¡€æ•°æ®
   npm run import:cities
   npm run import:airports
   ```

2. **æ—¥å¸¸å¼€å‘**ï¼š
   ```bash
   # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
   npm run backend:dev
   
   # åœ¨å¦ä¸€ä¸ªç»ˆç«¯è¿è¡Œæµ‹è¯•
   npm run test:watch
   ```

3. **æ•°æ®æ›´æ–°æµç¨‹**ï¼š
   ```bash
   # çˆ¬å–æ–°æ•°æ®
   npm run scrape:alltrails
   
   # å¯¼å…¥åˆ°æ•°æ®åº“
   npm run import:alltrails
   
   # æ›´æ–°å…ƒæ•°æ®
   npm run update:alltrails:elevation
   ```

4. **è°ƒè¯•æ•°æ®é—®é¢˜**ï¼š
   ```bash
   # è¯Šæ–­é—®é¢˜
   npm run diagnose:place
   
   # æ£€æŸ¥æ•°æ®
   npm run check:place-coords
   
   # ä¿®å¤é—®é¢˜
   npm run fix:coordinates
   ```

---

## éƒ¨ç½²è¯´æ˜
