# 河网地理数据存放目录

## 📁 目录结构

请将全球河网数据按以下结构放置：

```
data/geographic/rivers/
├── rivers_line/              # 线状水系（river/stream centerline）
│   ├── 世界线状水系.shp
│   ├── 世界线状水系.shx
│   ├── 世界线状水系.dbf
│   ├── 世界线状水系.prj
│   └── ... (其他配套文件)
├── water_poly/               # 面状水系（water polygon）
│   ├── 世界面状水系.shp
│   ├── 世界面状水系.shx
│   ├── 世界面状水系.dbf
│   ├── 世界面状水系.prj
│   └── ... (其他配套文件)
└── country/                  # 国家边界
    ├── country.shp
    ├── country.shx
    ├── country.dbf
    ├── country.prj
    └── ... (其他配套文件)
```

## 📦 数据格式要求

### Shapefile 必需文件

每个 shapefile 必须包含以下文件（**缺一不可**）：

- **`.shp`** - 几何数据（线/面）
- **`.shx`** - 空间索引
- **`.dbf`** - 属性表（字段信息）
- **`.prj`** - 坐标系定义（**非常关键**）

### 可选文件

- `.sbn/.sbx` - 空间索引（有的话查询更快）
- `.shp.xml` - 元数据

## 🗜️ 压缩格式

**支持压缩包格式**：`.zip` 或 `.7z`

压缩包内应保持上述目录结构，例如：

```
rivers-data.zip
├── rivers_line/
│   └── 世界线状水系.*
├── water_poly/
│   └── 世界面状水系.*
└── country/
    └── country.*
```

## 📋 数据用途

### 线状水系（rivers_line）

用于计算：
- **距离**：点到最近河线的距离
- **穿越次数**：路线与河线相交次数
- **河网密度**：区域内河线总长度/条数
- **路线风险触发**：基于穿越次数和密度的风险评估

### 面状水系（water_poly）

用于：
- **靠近水域判断**：点到水域面的距离
- **湿地/景观识别**：水边景观推荐
- **地图展示**：真实水域边界可视化

### 国家边界（country）

用于：
- **区域裁剪**：按国家/区域过滤数据
- **分区统计**：按国家统计河网特征

## 🚀 下一步

1. 将数据文件放置到对应目录
2. 运行导入脚本：`npm run import:rivers` 或 `ts-node scripts/import-rivers-to-postgis.ts`
3. 数据会自动导入到 PostGIS 数据库

## 📝 注意事项

- 确保 `.prj` 文件存在，否则无法正确识别坐标系
- 如果坐标系不是 EPSG:4326（WGS84），导入脚本会自动转换
- 导入前建议检查 `.dbf` 文件中的字段，了解有哪些属性可用（如河流名称、等级、Strahler order 等）

