generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [postgis]
}

model City {
  id          Int                       @id @default(autoincrement())
  name        String // æœ¬åœ°åç§°ï¼ˆä¸»åç§°ï¼‰
  nameCN      String? // ä¸­æ–‡åç§°
  nameEN      String? // è‹±æ–‡åç§°
  countryCode String // ISO 3166-1 alpha-2
  location    Unsupported("geography")? // PostGIS Pointï¼ˆç»çº¬åº¦ï¼‰
  timezone    String? // æ—¶åŒºï¼ˆå¦‚ "Asia/Shanghai", "America/New_York"ï¼‰
  adcode      String? // è¡Œæ”¿åŒºåˆ’ä»£ç ï¼ˆä¸»è¦ç”¨äºä¸­å›½åŸå¸‚ï¼‰
  metadata    Json? // æ‰©å±•ä¿¡æ¯ï¼ˆè¡Œæ”¿åŒºåˆ’ã€å¤–éƒ¨IDã€å…¶ä»–è¯­è¨€åç§°ç­‰ï¼‰
  places      Place[]

  @@index([countryCode])
  @@index([name])
  @@index([nameCN])
  @@index([nameEN])
}

/// å›½å®¶æ¡£æ¡ˆè¡¨
/// 
/// å­—æ®µåˆ†ç±»ï¼š
/// ğŸŒ é€šç”¨å­—æ®µï¼šé€‚ç”¨äºæ‰€æœ‰å›½å®¶ç”¨æˆ·ï¼ˆisoCode, currencyCode, paymentType, powerInfo, emergencyç­‰ï¼‰
/// ğŸ‡¨ğŸ‡³ ä¸­å›½ç‰¹å®šå­—æ®µï¼šä»…å¯¹ä¸­å›½ç”¨æˆ·æœ‰æ„ä¹‰ï¼ˆvisaForCN, exchangeRateToCNYï¼‰
/// 
/// å›½é™…åŒ–æ‰©å±•å»ºè®®ï¼š
/// - æ·»åŠ  nameEN å­—æ®µæ”¯æŒè‹±æ–‡åç§°
/// - exchangeRateToCNY å¯æ‰©å±•ä¸º exchangeRateToUSDï¼ˆå›½é™…æ ‡å‡†åŸºå‡†ï¼‰
/// - visaForCN å¯æ‰©å±•ä¸º VisaPolicy è¡¨æ”¯æŒå¤šå›½å®¶ç»„åˆ
model CountryProfile {
  // ========== ğŸŒ é€šç”¨å­—æ®µ ==========
  isoCode String  @id @unique // å›½å®¶ä»£ç ï¼ˆISO 3166-1 alpha-2ï¼‰
  nameCN  String // ä¸­æ–‡åç§°ï¼ˆä¸»è¦æ˜¾ç¤ºï¼‰
  nameEN  String? // è‹±æ–‡åç§°ï¼ˆç”¨äºå›½é™…åŒ–ï¼‰

  // è´§å¸ä¿¡æ¯ï¼ˆé€šç”¨ï¼‰
  currencyCode String? // è´§å¸ä»£ç ï¼ˆISO 4217ï¼‰
  currencyName String? // è´§å¸åç§°
  paymentType  PaymentType? // æ”¯ä»˜ç”»åƒï¼ˆCASH_HEAVY, BALANCED, DIGITAL_ONLYï¼‰
  paymentInfo  Json? // æ”¯ä»˜å®ç”¨å»ºè®®ï¼ˆå°è´¹ã€ATMã€é’±åŒ…Appç­‰ï¼‰

  // å®ç”¨ä¿¡æ¯ï¼ˆé€šç”¨ï¼‰
  powerInfo Json? // æ’åº§ä¿¡æ¯ï¼ˆç”µå‹ã€é¢‘ç‡ã€æ’åº§ç±»å‹ï¼‰
  emergency Json? // ç´§æ€¥ç”µè¯ï¼ˆæŠ¥è­¦ã€ç«è­¦ã€åŒ»ç–—ï¼‰

  // ========== ğŸ‡¨ğŸ‡³ ä¸­å›½ç‰¹å®šå­—æ®µ ==========
  exchangeRateToCNY Float? // ğŸ‡¨ğŸ‡³ æ±‡ç‡ï¼ˆ1 å¤–å¸ = å¤šå°‘ CNYï¼‰- ä»…å¯¹ä¸­å›½ç”¨æˆ·
  visaForCN         Json? // ğŸ‡¨ğŸ‡³ é’ˆå¯¹ä¸­å›½å…¬æ°‘çš„ç­¾è¯æ”¿ç­–ï¼ˆstatus, requirement, allowedStay, notesï¼‰

  // ========== ğŸŒ å›½é™…åŒ–æ‰©å±•å­—æ®µ ==========
  exchangeRateToUSD Float? // ğŸŒ æ±‡ç‡ï¼ˆ1 å¤–å¸ = å¤šå°‘ USDï¼‰- å›½é™…æ ‡å‡†åŸºå‡†ï¼Œé€‚ç”¨äºæ‰€æœ‰ç”¨æˆ·

  updatedAt DateTime
}

model DayOfWeekFactor {
  id            Int      @id @default(autoincrement())
  dayOfWeek     Int      @unique
  factor        Float
  sampleCount   Int      @default(0)
  avgPrice      Float?
  totalAvgPrice Float?
  lastUpdated   DateTime @default(now())
  updatedAt     DateTime
}

model FlightPriceDetail {
  id                          Int      @id @default(autoincrement())
  routeId                     String
  originCity                  String
  destinationCity             String
  month                       Int
  dayOfWeek                   Int?
  monthlyBasePrice            Float
  dayOfWeekFactor             Float?
  sampleCount                 Int      @default(0)
  minPrice                    Float?
  maxPrice                    Float?
  stdDev                      Float?
  source                      String?  @default("2023-2024å¹´å†å²æ•°æ®")
  lastUpdated                 DateTime @default(now())
  createdAt                   DateTime @default(now())
  updatedAt                   DateTime
  destinationAirport          String?
  destinationAirportLatitude  Float?
  destinationAirportLongitude Float?
  originAirport               String?
  originAirportLatitude       Float?
  originAirportLongitude      Float?
  airlineCount                Int?     @default(0)
  arrivalTime                 String?
  departureTime               String?
  distanceKm                  Float?
  isWeekend                   Boolean? @default(false)
  monthFactor                 Float?
  timeOfDayFactor             Float?

  @@unique([routeId, month, dayOfWeek])
  @@index([originCity, destinationCity])
  @@index([routeId, month, dayOfWeek])
  @@index([routeId, month])
}

model FlightPriceReference {
  id              Int      @id @default(autoincrement())
  countryCode     String   @db.VarChar(2)
  originCity      String?  @db.VarChar(10)
  lowSeasonPrice  Int
  highSeasonPrice Int
  averagePrice    Int
  visaCost        Int      @default(0)
  source          String?  @db.VarChar(255)
  lastUpdated     DateTime @default(now()) @db.Timestamp(6)
  notes           String?
  createdAt       DateTime @default(now()) @db.Timestamp(6)
  updatedAt       DateTime @default(now()) @db.Timestamp(6)

  @@index([countryCode])
  @@index([countryCode, originCity])
}

model ItineraryItem {
  id        String    @id
  startTime DateTime?
  endTime   DateTime?
  type      ItemType
  placeId   Int?
  trailId   Int? // æ–°å¢ï¼šå¾’æ­¥è·¯çº¿ID
  tripDayId String
  note      String?
  place     Place?    @relation(fields: [placeId], references: [id])
  trail     Trail?    @relation(fields: [trailId], references: [id])
  tripDay   TripDay   @relation(fields: [tripDayId], references: [id])
}

model Place {
  id               Int                       @id @default(autoincrement())
  uuid             String                    @unique
  nameCN           String // ä¸­æ–‡åç§°ï¼ˆä¸»è¦æ˜¾ç¤ºï¼‰
  nameEN           String? // è‹±æ–‡åç§°ï¼ˆç”¨äºå›½é™…åŒ–ï¼‰
  category         PlaceCategory
  location         Unsupported("geography")?
  address          String?
  cityId           Int?
  metadata         Json?
  physicalMetadata Json?
  googlePlaceId    String?                   @unique
  rating           Float?                    @default(0)
  createdAt        DateTime                  @default(now())
  updatedAt        DateTime
  itineraryItems   ItineraryItem[]
  city             City?                     @relation(fields: [cityId], references: [id])
  // æ–°å¢ï¼šå¾’æ­¥è·¯çº¿å…³è”
  trailsAsStart    Trail[]                   @relation("TrailStartPlace")
  trailsAsEnd      Trail[]                   @relation("TrailEndPlace")
  trailWaypoints   TrailWaypoint[]

  @@index([metadata(ops: JsonbPathOps)], type: Gin)
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model RawFlightData {
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // å‡ºå‘åŸå¸‚ String? @map("å‡ºå‘åŸå¸‚") @db.VarChar(50)
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // åˆ°è¾¾åŸå¸‚ String? @map("åˆ°è¾¾åŸå¸‚") @db.VarChar(50)
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // é‡Œç¨‹å…¬é‡Œ Decimal? @map("é‡Œç¨‹å…¬é‡Œ") @db.Decimal
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // èˆªç­ç­æ¬¡ String? @map("èˆªç­ç­æ¬¡") @db.VarChar(20)
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // èˆªç©ºå…¬å¸ String? @map("èˆªç©ºå…¬å¸") @db.VarChar(50)
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // èµ·é£æœºåœº String? @map("èµ·é£æœºåœº") @db.VarChar(100)
  originAirportY      Decimal? @map("èµ·é£æœºåœºy") @db.Decimal
  originAirportX      Decimal? @map("èµ·é£æœºåœºx") @db.Decimal
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // é™è½æœºåœº String? @map("é™è½æœºåœº") @db.VarChar(100)
  destinationAirportY Decimal? @map("é™è½æœºåœºy") @db.Decimal
  destinationAirportX Decimal? @map("é™è½æœºåœºx") @db.Decimal

  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // èµ·é£æ—¶é—´ DateTime? @map("èµ·é£æ—¶é—´") @db.Time(6)
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // é™è½æ—¶é—´ DateTime? @map("é™è½æ—¶é—´") @db.Time(6)
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // æ—¥æœŸ DateTime? @map("æ—¥æœŸ") @db.Date
  /// This field was commented out because of an invalid name. Please provide a valid one that matches [a-zA-Z][a-zA-Z0-9_]*
  // ä»·æ ¼å…ƒ Int? @map("ä»·æ ¼å…ƒ")
  @@ignore
}

model Trip {
  id            String             @id
  destination   String
  startDate     DateTime
  endDate       DateTime
  budgetConfig  Json?
  pacingConfig  Json?
  metadata      Json? // æ‰©å±•ä¿¡æ¯ï¼ˆåˆ†äº«é“¾æ¥ã€ç¦»çº¿æ•°æ®åŒ…ç­‰ï¼‰
  createdAt     DateTime           @default(now())
  updatedAt     DateTime
  days          TripDay[]
  collaborators TripCollaborator[]
  shares        TripShare[]
  collections   TripCollection[]
  likes         TripLike[]
}

model TripDay {
  id     String          @id
  date   DateTime
  tripId String
  items  ItineraryItem[]
  trip   Trip            @relation(fields: [tripId], references: [id])
}

/**
 * å¾’æ­¥è·¯çº¿è¡¨
 * å­˜å‚¨å¾’æ­¥è·¯çº¿çš„å®Œæ•´ä¿¡æ¯ï¼ŒåŒ…æ‹¬GPXè½¨è¿¹ã€éš¾åº¦è¯„ä¼°ç­‰
 */
model Trail {
  id          Int     @id @default(autoincrement())
  uuid        String  @unique
  nameCN      String // ä¸­æ–‡åç§°ï¼ˆä¸»è¦æ˜¾ç¤ºï¼‰
  nameEN      String? // è‹±æ–‡åç§°
  description String? // è·¯çº¿æè¿°

  // è·¯çº¿åŸºæœ¬ä¿¡æ¯
  distanceKm     Float? // æ€»è·ç¦»ï¼ˆå…¬é‡Œï¼‰
  elevationGainM Float? // ç´¯è®¡çˆ¬å‡ï¼ˆç±³ï¼‰
  elevationLossM Float? // ç´¯è®¡ä¸‹é™ï¼ˆç±³ï¼‰
  maxElevationM  Float? // æœ€é«˜æµ·æ‹”ï¼ˆç±³ï¼‰
  minElevationM  Float? // æœ€ä½æµ·æ‹”ï¼ˆç±³ï¼‰
  averageSlope   Float? // å¹³å‡å¡åº¦ï¼ˆ%ï¼‰

  // éš¾åº¦è¯„ä¼°
  difficultyLevel      String? // EXTREME, HARD, MODERATE, EASY
  equivalentDistanceKm Float? // ç­‰æ•ˆè·ç¦»ï¼ˆå…¬é‡Œï¼‰
  fatigueScore         Float? // ç–²åŠ³è¯„åˆ†

  // è½¨è¿¹æ•°æ®
  gpxData    Json? // GPXè½¨è¿¹æ•°æ®ï¼ˆJSONæ ¼å¼ï¼ŒåŒ…å«åæ ‡ç‚¹æ•°ç»„ï¼‰
  gpxFileUrl String? // GPXæ–‡ä»¶URLï¼ˆå¦‚æœå­˜å‚¨åœ¨å¤–éƒ¨ï¼‰
  bounds     Json? // è¾¹ç•Œæ¡† {minlat, minlon, maxlat, maxlon}

  // å…³è”çš„Place
  startPlaceId Int? // èµ·ç‚¹Place ID
  endPlaceId   Int? // ç»ˆç‚¹Place ID
  startPlace   Place? @relation("TrailStartPlace", fields: [startPlaceId], references: [id])
  endPlace     Place? @relation("TrailEndPlace", fields: [endPlaceId], references: [id])

  // é€”ç»ç‚¹ï¼ˆå¤šå¯¹å¤šå…³ç³»ï¼‰
  waypoints TrailWaypoint[]

  // å…ƒæ•°æ®
  metadata  Json? // æ‰©å±•ä¿¡æ¯ï¼ˆæ¥æºã€è¯„åˆ†ã€æ³¨æ„äº‹é¡¹ç­‰ï¼‰
  source    String? // æ•°æ®æ¥æºï¼ˆalltrails, gpx, manualç­‰ï¼‰
  sourceUrl String? // æ¥æºé“¾æ¥
  rating    Float? // è¯„åˆ†

  // æ—¶é—´ä¼°ç®—
  estimatedDurationHours Float? // é¢„è®¡è€—æ—¶ï¼ˆå°æ—¶ï¼‰

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // å…³è”
  itineraryItems ItineraryItem[]

  @@index([startPlaceId])
  @@index([endPlaceId])
  @@index([difficultyLevel])
  @@index([source])
}

/**
 * å¾’æ­¥è·¯çº¿é€”ç»ç‚¹è¡¨
 * å­˜å‚¨è·¯çº¿çš„é€”ç»ç‚¹ï¼ˆä¸­é—´ç‚¹ï¼‰
 */
model TrailWaypoint {
  id      Int     @id @default(autoincrement())
  trailId Int
  placeId Int
  order   Int // é€”ç»ç‚¹é¡ºåºï¼ˆä»èµ·ç‚¹åˆ°ç»ˆç‚¹ï¼Œä»0å¼€å§‹ï¼‰
  note    String? // é€”ç»ç‚¹å¤‡æ³¨

  trail Trail @relation(fields: [trailId], references: [id], onDelete: Cascade)
  place Place @relation(fields: [placeId], references: [id])

  @@unique([trailId, placeId])
  @@index([trailId])
  @@index([placeId])
}

/// This table has subclasses and requires additional setup for migrations. Visit https://pris.ly/d/table-inheritance for more info.
/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model postgres_log {
  log_time               DateTime? @db.Timestamptz(3)
  user_name              String?
  database_name          String?
  process_id             Int?
  connection_from        String?
  session_id             String
  session_line_num       BigInt
  command_tag            String?
  session_start_time     DateTime? @db.Timestamptz(6)
  virtual_transaction_id String?
  transaction_id         BigInt?
  error_severity         String?
  sql_state_code         String?
  message                String?
  detail                 String?
  hint                   String?
  internal_query         String?
  internal_query_pos     Int?
  context                String?
  query                  String?
  query_pos              Int?
  location               String?
  application_name       String?
  backend_type           String?
  leader_pid             Int?
  query_id               BigInt?

  @@ignore
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model spatial_ref_sys {
  srid      Int     @id
  auth_name String? @db.VarChar(256)
  auth_srid Int?
  srtext    String? @db.VarChar(2048)
  proj4text String? @db.VarChar(2048)
}

enum ItemType {
  ACTIVITY
  REST
  MEAL_ANCHOR
  MEAL_FLOATING
  TRANSIT
}

enum PaymentType {
  CASH_HEAVY
  BALANCED
  DIGITAL_ONLY
}

enum PlaceCategory {
  ATTRACTION
  RESTAURANT
  SHOPPING
  HOTEL
  TRANSIT_HUB
}

/**
 * åŸå§‹é…’åº—åŸºæœ¬ä¿¡æ¯è¡¨
 * åŒ…å«é…’åº—çš„åŸºæœ¬ä¿¡æ¯ï¼šåç§°ã€å“ç‰Œã€åœ°å€ã€ä½ç½®ç­‰
 * æ•°æ®æ¥æºï¼šhotel_basic_info.csv
 * å­—æ®µï¼šid, name, brand, address, city, district, lat, lng, phone, type, adcode
 */
model RawHotelData_Slim {
  id       String  @id // é…’åº—IDï¼Œå¦‚ "B0K1PZBE68"
  name     String? // é…’åº—åç§°ï¼Œå¦‚ "æ¡”å­é…’åº—(æ´›é˜³é¾™é—¨ç«™åº—)"
  brand    String? // å“ç‰Œï¼Œå¦‚ "æ¡”å­"
  address  String? // åœ°å€ï¼Œå¦‚ "é€šè¡¢è·¯ä¸åšè½½é—¨è¡—äº¤å‰å£è¥¿å—è§’æ–°å”è¡—3å·æ¥¼"
  city     String? // åŸå¸‚ï¼Œå¦‚ "æ´›é˜³å¸‚"
  district String? // åŒºå¿ï¼Œå¦‚ "æ´›é¾™åŒº"
  lat      Float? // çº¬åº¦ï¼Œå¦‚ 34.596104
  lng      Float? // ç»åº¦ï¼Œå¦‚ 112.46321
  phone    String? // ç”µè¯ï¼Œå¦‚ "0379-63168888;18603798508"
  type     String? // ç±»å‹ï¼Œå¦‚ "ä½å®¿æœåŠ¡;å®¾é¦†é…’åº—;å®¾é¦†é…’åº—"
  adcode   String? // è¡Œæ”¿åŒºåˆ’ä»£ç ï¼Œå¦‚ "410300"

  @@index([city])
  @@index([brand])
  @@index([city, brand])
  @@index([city, district])
}

/**
 * é…’åº—å­£åº¦ä»·æ ¼æ•°æ®è¡¨ï¼ˆå®½è¡¨æ ¼å¼ï¼‰
 * æŒ‰åŸå¸‚ã€æ˜Ÿçº§ã€å­£åº¦å­˜å‚¨ä»·æ ¼æ•°æ®
 * å­£åº¦å­—æ®µï¼š2018_Q1 åˆ° 2024_Q1
 */
model HotelWideData_Quarterly {
  id         Int     @id @default(autoincrement())
  city       String?
  starRating Int?
  /// 2018å¹´ç¬¬ä¸€å­£åº¦ä»·æ ¼
  /// @map("2018_Q1")
  q2018_Q1   Float?  @map("2018_Q1")
  /// 2018å¹´ç¬¬äºŒå­£åº¦ä»·æ ¼
  /// @map("2018_Q2")
  q2018_Q2   Float?  @map("2018_Q2")
  /// 2018å¹´ç¬¬ä¸‰å­£åº¦ä»·æ ¼
  /// @map("2018_Q3")
  q2018_Q3   Float?  @map("2018_Q3")
  /// 2018å¹´ç¬¬å››å­£åº¦ä»·æ ¼
  /// @map("2018_Q4")
  q2018_Q4   Float?  @map("2018_Q4")
  /// 2019å¹´ç¬¬ä¸€å­£åº¦ä»·æ ¼
  /// @map("2019_Q1")
  q2019_Q1   Float?  @map("2019_Q1")
  /// 2019å¹´ç¬¬äºŒå­£åº¦ä»·æ ¼
  /// @map("2019_Q2")
  q2019_Q2   Float?  @map("2019_Q2")
  /// 2019å¹´ç¬¬ä¸‰å­£åº¦ä»·æ ¼
  /// @map("2019_Q3")
  q2019_Q3   Float?  @map("2019_Q3")
  /// 2019å¹´ç¬¬å››å­£åº¦ä»·æ ¼
  /// @map("2019_Q4")
  q2019_Q4   Float?  @map("2019_Q4")
  /// 2020å¹´ç¬¬ä¸€å­£åº¦ä»·æ ¼
  /// @map("2020_Q1")
  q2020_Q1   Float?  @map("2020_Q1")
  /// 2020å¹´ç¬¬äºŒå­£åº¦ä»·æ ¼
  /// @map("2020_Q2")
  q2020_Q2   Float?  @map("2020_Q2")
  /// 2020å¹´ç¬¬ä¸‰å­£åº¦ä»·æ ¼
  /// @map("2020_Q3")
  q2020_Q3   Float?  @map("2020_Q3")
  /// 2020å¹´ç¬¬å››å­£åº¦ä»·æ ¼
  /// @map("2020_Q4")
  q2020_Q4   Float?  @map("2020_Q4")
  /// 2021å¹´ç¬¬ä¸€å­£åº¦ä»·æ ¼
  /// @map("2021_Q1")
  q2021_Q1   Float?  @map("2021_Q1")
  /// 2021å¹´ç¬¬äºŒå­£åº¦ä»·æ ¼
  /// @map("2021_Q2")
  q2021_Q2   Float?  @map("2021_Q2")
  /// 2021å¹´ç¬¬ä¸‰å­£åº¦ä»·æ ¼
  /// @map("2021_Q3")
  q2021_Q3   Float?  @map("2021_Q3")
  /// 2021å¹´ç¬¬å››å­£åº¦ä»·æ ¼
  /// @map("2021_Q4")
  q2021_Q4   Float?  @map("2021_Q4")
  /// 2022å¹´ç¬¬ä¸€å­£åº¦ä»·æ ¼
  /// @map("2022_Q1")
  q2022_Q1   Float?  @map("2022_Q1")
  /// 2022å¹´ç¬¬äºŒå­£åº¦ä»·æ ¼
  /// @map("2022_Q2")
  q2022_Q2   Float?  @map("2022_Q2")
  /// 2022å¹´ç¬¬ä¸‰å­£åº¦ä»·æ ¼
  /// @map("2022_Q3")
  q2022_Q3   Float?  @map("2022_Q3")
  /// 2022å¹´ç¬¬å››å­£åº¦ä»·æ ¼
  /// @map("2022_Q4")
  q2022_Q4   Float?  @map("2022_Q4")
  /// 2023å¹´ç¬¬ä¸€å­£åº¦ä»·æ ¼
  /// @map("2023_Q1")
  q2023_Q1   Float?  @map("2023_Q1")
  /// 2023å¹´ç¬¬äºŒå­£åº¦ä»·æ ¼
  /// @map("2023_Q2")
  q2023_Q2   Float?  @map("2023_Q2")
  /// 2023å¹´ç¬¬ä¸‰å­£åº¦ä»·æ ¼
  /// @map("2023_Q3")
  q2023_Q3   Float?  @map("2023_Q3")
  /// 2023å¹´ç¬¬å››å­£åº¦ä»·æ ¼
  /// @map("2023_Q4")
  q2023_Q4   Float?  @map("2023_Q4")
  /// 2024å¹´ç¬¬ä¸€å­£åº¦ä»·æ ¼
  /// @map("2024_Q1")
  q2024_Q1   Float?  @map("2024_Q1")

  @@index([city])
  @@index([starRating])
  @@index([city, starRating])
}

/**
 * åŸå§‹æ™¯ç‚¹æ•°æ®è¡¨
 * å­˜å‚¨ä»å¤–éƒ¨æ•°æ®æºå¯¼å…¥çš„æ™¯ç‚¹åŸºç¡€ä¿¡æ¯
 * æ•°æ®æ¥æºï¼šä¸­å›½æ™¯ç‚¹æ•°æ® CSV æ–‡ä»¶
 * å­—æ®µè¯´æ˜ï¼š
 * - name: æ™¯åŒºåç§°
 * - level: ç­‰çº§ï¼ˆå¦‚ 5A, 4A ç­‰ï¼‰
 * - address: è¯¦ç»†åœ°å€
 * - province: çœçº§è¡Œæ”¿åŒº
 * - publishDate: ç›¸å…³æ–‡ä»¶å‘å¸ƒæ—¶é—´
 * - documentUrl: æ–‡ä»¶ç½‘å€é“¾æ¥
 * - encodedAddress: ç¼–ç åœ°å€ï¼ˆå®Œæ•´åœ°å€å­—ç¬¦ä¸²ï¼‰
 * - lng: ç»åº¦ï¼ˆWGS84ï¼‰
 * - lat: çº¬åº¦ï¼ˆWGS84ï¼‰
 */
model RawAttractionData {
  id             Int      @id @default(autoincrement())
  name           String // æ™¯åŒºåç§°
  level          String? // ç­‰çº§ï¼ˆ5A, 4A, 3A ç­‰ï¼‰
  address        String? // åœ°å€
  province       String? // çœçº§è¡Œæ”¿åŒº
  publishDate    String? // ç›¸å…³æ–‡ä»¶å‘å¸ƒæ—¶é—´ï¼ˆå¦‚ 2025.04.15ï¼‰
  documentUrl    String? // æ–‡ä»¶ç½‘å€é“¾æ¥
  encodedAddress String? // ç¼–ç åœ°å€
  lng            Float? // ç»åº¦ï¼ˆWGS84ï¼‰
  lat            Float? // çº¬åº¦ï¼ˆWGS84ï¼‰
  importedAt     DateTime @default(now()) // å¯¼å…¥æ—¶é—´
  processed      Boolean  @default(false) // æ˜¯å¦å·²å¤„ç†ï¼ˆè½¬æ¢ä¸º Placeï¼‰

  @@index([province])
  @@index([level])
  @@index([province, level])
  @@index([processed])
}

/**
 * åŸå§‹ç«è½¦ç«™æ•°æ®è¡¨
 * å­˜å‚¨ä»å¤–éƒ¨æ•°æ®æºå¯¼å…¥çš„ç«è½¦ç«™åŸºç¡€ä¿¡æ¯
 * æ•°æ®æ¥æºï¼šå…¨å›½ç«è½¦ç«™æ•°æ® CSV æ–‡ä»¶
 * å­—æ®µè¯´æ˜ï¼š
 * - name: ç«™å
 * - address: è½¦ç«™åœ°å€
 * - railwayBureau: é“è·¯å±€
 * - category: ç±»åˆ«
 * - nature: æ€§è´¨ï¼ˆå®¢è¿ç«™ã€è´§è¿ç«™ç­‰ï¼‰
 * - province: çœ
 * - city: å¸‚
 * - wgs84Lng: ç»åº¦ï¼ˆWGS84ï¼‰
 * - wgs84Lat: çº¬åº¦ï¼ˆWGS84ï¼‰
 */
model RawTrainStationData {
  id            Int      @id @default(autoincrement())
  name          String // ç«™å
  address       String? // è½¦ç«™åœ°å€
  railwayBureau String? // é“è·¯å±€
  category      String? // ç±»åˆ«
  nature        String? // æ€§è´¨ï¼ˆå®¢è¿ç«™ã€è´§è¿ç«™ç­‰ï¼‰
  province      String? // çœ
  city          String? // å¸‚
  wgs84Lng      Float? // ç»åº¦ï¼ˆWGS84ï¼‰
  wgs84Lat      Float? // çº¬åº¦ï¼ˆWGS84ï¼‰
  importedAt    DateTime @default(now()) // å¯¼å…¥æ—¶é—´
  processed     Boolean  @default(false) // æ˜¯å¦å·²å¤„ç†ï¼ˆè½¬æ¢ä¸º Placeï¼‰

  @@index([province])
  @@index([city])
  @@index([province, city])
  @@index([railwayBureau])
  @@index([nature])
  @@index([processed])
}

/**
 * é…’åº—ä»·æ ¼æŸ¥æ‰¾è¡¨ï¼ˆåŸå¸‚ç»´åº¦ï¼‰
 * ä» HotelWideData_Quarterly èšåˆç”Ÿæˆ
 * åŒ…å«æ¯ä¸ªåŸå¸‚çš„åŸºç¡€ä»·æ ¼ç»Ÿè®¡ä¿¡æ¯
 */
model HotelPriceDetail {
  city        String   @id
  avgPrice    Float? // å¹³å‡ä»·æ ¼
  medianPrice Float? // ä¸­ä½æ•°ä»·æ ¼ï¼ˆä¸»è¦ä½¿ç”¨ï¼‰
  cityFactor  Float? // åŸå¸‚å› å­ï¼ˆç›¸å¯¹äºå…¨å›½å¹³å‡ä»·çš„å€æ•°ï¼‰
  sampleCount Int      @default(0) // æ ·æœ¬æ•°é‡
  minPrice    Float? // æœ€ä½ä»·æ ¼
  maxPrice    Float? // æœ€é«˜ä»·æ ¼
  stdDev      Float? // æ ‡å‡†å·®
  createdAt   DateTime @default(now())
  updatedAt   DateTime @default(now())

  @@index([city])
}

/**
 * åŸå¸‚-æ˜Ÿçº§ä»·æ ¼æŸ¥æ‰¾è¡¨ï¼ˆè´¨é‡ç»´åº¦ï¼‰
 * ä» HotelWideData_Quarterly èšåˆç”Ÿæˆ
 * åŒ…å«æ¯ä¸ªåŸå¸‚-æ˜Ÿçº§ç»„åˆçš„ä»·æ ¼ç»Ÿè®¡å’Œè´¨é‡è°ƒæ•´å› å­
 */
model StarCityPriceDetail {
  city           String
  starRating     Int
  avgPrice       Float? // è¯¥åŸå¸‚-æ˜Ÿçº§çš„å¹³å‡ä»·æ ¼
  cityStarFactor Float? // åŸå¸‚-æ˜Ÿçº§å› å­ï¼ˆç›¸å¯¹äºè¯¥åŸå¸‚å¹³å‡ä»·çš„å€æ•°ï¼‰
  sampleCount    Int      @default(0) // æ ·æœ¬æ•°é‡
  minPrice       Float? // æœ€ä½ä»·æ ¼
  maxPrice       Float? // æœ€é«˜ä»·æ ¼
  stdDev         Float? // æ ‡å‡†å·®
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now())

  @@id([city, starRating])
  @@index([city])
  @@index([starRating])
  @@index([city, starRating])
}

/// ç”¨æˆ·ç”»åƒè¡¨
/// å­˜å‚¨ç”¨æˆ·çš„é•¿æœŸåå¥½ä¿¡æ¯ï¼ˆæ™¯ç‚¹åå¥½ã€é¥®é£Ÿç¦å¿Œã€å‡ºè¡Œåå¥½ç­‰ï¼‰
model UserProfile {
  userId      String   @id // ç”¨æˆ·IDï¼ˆå¯ä»¥æ˜¯å¤–éƒ¨ç³»ç»Ÿçš„ç”¨æˆ·IDï¼‰
  preferences Json? // ç”¨æˆ·åå¥½ï¼ˆæ™¯ç‚¹ç±»å‹ã€é¥®é£Ÿç¦å¿Œã€æ˜¯å¦åå¥½å°ä¼—æ™¯ç‚¹ç­‰ï¼‰
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([userId])
}

/// è¡Œç¨‹æ¨¡æ¿è¡¨
/// å­˜å‚¨ä¸åŒä¸»é¢˜çš„è¡Œç¨‹æ¨¡æ¿ï¼ˆå¦‚äº²å­æ¸¸ã€ç‰¹ç§å…µæ—…æ¸¸ã€ä¼‘é—²åº¦å‡ï¼‰
model TripTemplate {
  id          String   @id @default(uuid())
  name        String // æ¨¡æ¿åç§°
  nameCN      String? // ä¸­æ–‡åç§°
  description String? // æ¨¡æ¿æè¿°
  theme       String // ä¸»é¢˜ï¼ˆFAMILY, BACKPACKER, LEISURE, BUSINESS ç­‰ï¼‰
  destination String? // æ¨èç›®çš„åœ°ï¼ˆå›½å®¶ä»£ç ï¼‰
  config      Json // æ¨¡æ¿é…ç½®ï¼ˆbudgetConfig, pacingConfig ç­‰ï¼‰
  isPublic    Boolean  @default(false) // æ˜¯å¦å…¬å¼€
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([theme])
  @@index([destination])
  @@index([isPublic])
}

/// è¡Œç¨‹åä½œè€…è¡¨
/// å­˜å‚¨è¡Œç¨‹çš„åä½œè€…ä¿¡æ¯ï¼ˆå¤šäººåä½œç¼–è¾‘ï¼‰
model TripCollaborator {
  id        String   @id @default(uuid())
  tripId    String
  userId    String // åä½œè€…ç”¨æˆ·ID
  role      String // è§’è‰²ï¼ˆVIEWER, EDITOR, OWNERï¼‰
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  trip      Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@unique([tripId, userId])
  @@index([tripId])
  @@index([userId])
}

/// è¡Œç¨‹åˆ†äº«è¡¨
/// å­˜å‚¨è¡Œç¨‹åˆ†äº«é“¾æ¥å’Œæƒé™è®¾ç½®
model TripShare {
  id         String    @id @default(uuid())
  tripId     String
  shareToken String    @unique // åˆ†äº«ä»¤ç‰Œï¼ˆç”¨äºç”Ÿæˆåˆ†äº«é“¾æ¥ï¼‰
  permission String    @default("VIEW") // æƒé™ï¼ˆVIEW, EDITï¼‰
  expiresAt  DateTime? // è¿‡æœŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
  trip       Trip      @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@index([tripId])
  @@index([shareToken])
}

/// è¡Œç¨‹æ”¶è—è¡¨
/// å­˜å‚¨ç”¨æˆ·æ”¶è—çš„è¡Œç¨‹
model TripCollection {
  id        String   @id @default(uuid())
  tripId    String
  userId    String // æ”¶è—è€…ç”¨æˆ·ID
  createdAt DateTime @default(now())
  trip      Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@unique([tripId, userId])
  @@index([tripId])
  @@index([userId])
}

/// è¡Œç¨‹ç‚¹èµè¡¨
/// å­˜å‚¨ç”¨æˆ·å¯¹è¡Œç¨‹çš„ç‚¹èµ
model TripLike {
  id        String   @id @default(uuid())
  tripId    String
  userId    String // ç‚¹èµè€…ç”¨æˆ·ID
  createdAt DateTime @default(now())
  trip      Trip     @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@unique([tripId, userId])
  @@index([tripId])
  @@index([userId])
}

/// ç¦»çº¿æ•°æ®åŒ…è¡¨
/// å­˜å‚¨è¡Œç¨‹çš„ç¦»çº¿æ•°æ®åŒ…ä¿¡æ¯
model TripOfflinePack {
  id        String   @id @default(uuid())
  tripId    String   @unique
  data      Json // ç¦»çº¿æ•°æ®åŒ…å†…å®¹ï¼ˆåŒ…å«åœ°ç‚¹è¯¦æƒ…ã€è·¯çº¿ã€Scheduleï¼‰
  version   Int      @default(1) // æ•°æ®åŒ…ç‰ˆæœ¬
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([tripId])
}
